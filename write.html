<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <title>Document</title>
    <script>
        // 작업 : 일기를 작성하면 localStorage에 저장한 다음 list.html로 이동
        //      - 저장을 위한 변수 : diaries 배열과 sequence 변수
        //          - 초기값 :          []             1
        //          - 이미 저장한 일기가 있다면 locatStorage에서 읽어온다
        let diaries = JSON.parse(localStorage.getItem('diaries'));
        let sequence = localStorage.getItem('sequence');
        if(diaries==null) {
            diaries = [];
        }
        if(sequence==null) {
            sequence = 1;
        }

        $(document).ready(function() {
            $('#add').click(function() {
                // diary 하나 생성
                const diary = {
                    index: sequence++,
                    day: $('#day').val(),           // yyyy-MM-dd
                    title: $('#title').val(),
                    content: $('#content').val()
                };
                // 배열의 뒤에 값을 추가한다
                // diaries.push(diary);
                // 배열의 앞에 값을 추가한다
                diaries.unshift(diary);

                // localStorage에 저장 : 데이터는 문자열로 변환해서 저장(객체 저장 불가능)
                // 객체나 객체 배열의 경우 json(객체를 문자열로 표현)으로 변경해서 저장
                localStorage.setItem('diaries', JSON.stringify(diaries));
                localStorage.setItem('sequence', sequence);
               
                // 이동
                location.href ='list.html';
            });
        })
    </script>
</head>
<body>
    <div id='page'>
        <div class="form-group">
            <label for="day">날짜:</label>
            <input type="date" class="form-control" id="day">
        </div>
        <div class="form-group">
            <label for="title">일기 제목:</label>
            <input type="text" class="form-control" id="title">
        </div>
        <div class="form-group">
            <label for="content">내용:</label>
            <textarea class="form-control" rows="10" id="content"></textarea>
        </div>
        <button id='add' class='btn btn-primary full'>작성</button>
    </div>
</body>
</html>